<!-- üîí Rail siempre visible -->
<app-sidebar></app-sidebar>

<!-- üß± Shell: reserva el ancho del rail y el alto de la navbar -->
<div class="app-shell">

  <!-- Navbar fija arriba -->
  <app-nav-bar></app-nav-bar>

  <!-- Header / buscador -->
  <div class="container-xxl px-3 px-md-4 py-3" id="top">
    <!-- ‚Ä¶ tu barra de b√∫squeda y header ‚Ä¶ -->
  </div>

  <!-- MIXES -->
  <section class="section container-xxl px-3 px-md-4 mt-4" data-section="mixes">
    @defer (on viewport; prefetch on idle) {
      <app-mixes-capsule />
    } @placeholder {
      <div class="row g-4">
        <div class="col-6 col-md-4 col-lg-2" *ngFor="let _ of [0,1,2,3,4,5]">
          <div class="random-card">
            <div class="sk-cover-square mb-2"></div>
            <div class="placeholder-glow mb-1"><span class="placeholder col-8"></span></div>
            <div class="placeholder-glow"><span class="placeholder col-5"></span></div>
          </div>
        </div>
      </div>
    } @loading {
      <div class="text-muted small">Cargando mixes‚Ä¶</div>
    }
  </section>

  <!-- PLAYLISTS AUTO -->
  <section class="section container-xxl px-3 px-md-4" data-section="playlists">
    @defer (on viewport; prefetch on idle) {
      <app-auto-playlists />
    } @placeholder {
      <div class="text-muted small">Preparando playlists‚Ä¶</div>
    } @loading {
      <div class="text-muted small">Cargando playlists‚Ä¶</div>
    }
  </section>

  <!-- RECOMENDACIONES -->
  <section class="section container-xxl px-3 px-md-4" data-section="recommended">
    @defer (on viewport; prefetch on idle) {
      <app-recommendations />
    } @placeholder {
      <div class="text-muted small">Buscando recomendaciones‚Ä¶</div>
    } @loading {
      <div class="text-muted small">Cargando‚Ä¶</div>
    }
  </section>

  <!-- RECOMENDADAS / RANDOM -->
  <section class="section container-xxl px-3 px-md-4">
    @defer (on viewport; prefetch on idle) {
      <app-random-tracks />
    } @placeholder {
      <div class="row g-4">
        <div class="col-6 col-md-4 col-lg-2" *ngFor="let _ of [0,1,2,3,4,5]">
          <div class="random-card">
            <div class="sk-cover-square mb-2"></div>
            <div class="placeholder-glow mb-1"><span class="placeholder col-8"></span></div>
            <div class="placeholder-glow"><span class="placeholder col-5"></span></div>
          </div>
        </div>
      </div>
    } @loading {
      <div class="text-muted small">Cargando recomendaciones‚Ä¶</div>
    }
  </section>

  <!-- ESCUCHADOS RECIENTEMENTE -->
  <section class="section container-xxl px-3 px-md-4">
    @defer (on viewport; prefetch on idle) {
      <app-recent-tracks />
    } @placeholder {
      <div class="row g-3">
        <div class="col-12 col-lg-4" *ngFor="let _ of [0,1,2]">
          <ul class="list-group list-group-flush">
            <li class="list-group-item bg-transparent px-0" *ngFor="let __ of [0,1,2]">
              <div class="d-flex align-items-center gap-3">
                <span class="sk-cover"></span>
                <div class="flex-grow-1">
                  <div class="placeholder-glow mb-1"><span class="placeholder col-7"></span></div>
                  <div class="placeholder-glow"><span class="placeholder col-4"></span></div>
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>
    } @loading {
      <div class="text-muted small">Cargando historial‚Ä¶</div>
    }
  </section>

<!-- PLAYLISTS P√öBLICAS -->
<section class="section container-xxl px-3 px-md-4">

  @defer (on viewport; prefetch on idle) {
    <app-public-playlist />
  } @placeholder {
    <div class="text-muted small">Buscando playlists de la comunidad‚Ä¶</div>
  } @loading {
    <div class="text-muted small">Cargando playlists p√∫blicas‚Ä¶</div>
  }
</section>




<!-- PLAYLISTS MANUALES (si es diferente de auto-playlists) -->
<section class="section container-xxl px-3 px-md-4">
  <h2 class="h4 fw-bold mb-3">Tus playlists creadas</h2>
  @defer (on immediate) {
    <app-playlists />
  } @placeholder {
    <div class="text-muted small">Cargando playlists‚Ä¶</div>
  }
</section>



<app-add-to-playlist></app-add-to-playlist>
<app-cover-player></app-cover-player>
<!-- Barra de reproducci√≥n fija siempre montada -->
<app-player-bar />
