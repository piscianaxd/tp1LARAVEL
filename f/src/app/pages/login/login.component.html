<div class="auth-wrap">
  <!-- Fondo animado -->
  <div class="bg-blobs"></div>
  <div class="bg-noise"></div>

  <!-- Card vidrio -->
  <div class="auth-card shadow-lg">
    <div class="brand text-center">
      <i class="bi bi-soundwave"></i>
      <h1 class="brand-title">Musify</h1>
      <p class="brand-sub">Música sin límites</p>
    </div>

    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" novalidate>
      <!-- Email -->
      <div class="mb-3">
        <label for="email" class="form-label">Correo electrónico</label>
        <div class="input-group has-icon">
          <span class="input-group-text"><i class="bi bi-at"></i></span>
          <input
            id="email"
            type="email"
            class="form-control"
            formControlName="email"
            placeholder="tu@email.com"
            [class.is-invalid]="email.invalid && (email.dirty || email.touched)"
            autocomplete="email"
            aria-describedby="emailHelp"
          />
        </div>
        <div class="invalid-feedback d-block" *ngIf="email.errors && (email.dirty || email.touched)">
          <span *ngIf="email.errors['required']">El correo es obligatorio.</span>
          <span *ngIf="email.errors['email']">Formato de correo no válido.</span>
        </div>
      </div>

      <!-- Password -->
      <div class="mb-2">
        <label for="password" class="form-label">Contraseña</label>
        <div class="input-group has-icon">
          <span class="input-group-text"><i class="bi bi-lock"></i></span>
          <input
            id="password"
            [type]="showPassword ? 'text' : 'password'"
            class="form-control"
            formControlName="password"
            placeholder="••••••••"
            [class.is-invalid]="password.invalid && (password.dirty || password.touched)"
            autocomplete="current-password"
          />
          <button type="button" class="btn btn-icon" (click)="togglePassword()" [attr.aria-pressed]="showPassword">
            <i class="bi" [ngClass]="showPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
          </button>
        </div>
        <div class="invalid-feedback d-block" *ngIf="password.errors && (password.dirty || password.touched)">
          <span *ngIf="password.errors['required']">La contraseña es obligatoria.</span>
          <span *ngIf="password.errors['minlength']">Mínimo {{password.errors['minlength'].requiredLength}} caracteres.</span>
        </div>
      </div>

      <!-- Recordarme + Olvidé -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="form-check">
          <input id="remember" class="form-check-input" type="checkbox" formControlName="remember" />
          <label for="remember" class="form-check-label">Recordarme</label>
        </div>
        <a class="link-muted" href="#" (click)="$event.preventDefault()">¿Olvidaste tu contraseña?</a>
      </div>

      <!-- Error API -->
      <div *ngIf="errorMessage" class="alert alert-danger text-center mb-3">
        <i class="bi bi-exclamation-triangle me-2"></i>{{ errorMessage }}
      </div>

      <!-- CTA -->
      <button
        class="btn btn-gradient w-100 mb-3"
        type="submit"
        [disabled]="loginForm.invalid || loading"
      >
        <span *ngIf="!loading"><i class="bi bi-box-arrow-in-right me-2"></i>Entrar</span>
        <span *ngIf="loading" class="d-inline-flex align-items-center">
          <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
          Verificando…
        </span>
      </button>

      <div class="text-center small text-muted mt-3">
        ¿No tenés cuenta? <a class="link-muted" routerLink="/register">Crear cuenta</a>
      </div>

    </form>
  </div>
</div>
